{"version":3,"sources":["App/MyPoints/Header/Header.jsx","App/MyPoints/Semester/ClassItem/ClassItem.jsx","App/MyPoints/Semester/Semester.jsx","App/MyPoints/MyPointsAPI.js","App/MyPoints/MyPoints.jsx","App/App.jsx","reportWebVitals.js","index.js"],"names":["Header","props","className","src","avgPoints","toFixed","onClick","reload","checkNone","checkAll","defaultProps","ClassItem","selectRef","React","createRef","name","credits","ref","onChange","setGrades","current","value","grades","gradesList","map","item","points","type","checkClassItem","checked","Semester","semesterName","selectSemester","semesterID","onlySelectSemester","classes","MyPointsAPI","fetchDB","fetch","then","response","json","defaultData","semesters","defaultClassesState","semester","getPoints","gradesName","filter","join","MyPoints","useState","firstLoad","setFirstLoad","data","setData","avgPointsState","setAvgPointsState","classesState","setClassesState","useEffect","sum","reduce","acc","cur","creditsSum","classItem","newGrades","newData","JSON","parse","stringify","window","location","ID","sort","a","b","reverse","ButtonAppBar","appRef","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"+UAkBe,SAASA,EAAOC,GAC7B,OACE,yBAAQC,UAAU,SAAlB,UACE,qBAAKA,UAAU,SAASC,IAAI,kBAC5B,gEACA,oBAAGD,UAAU,aAAb,2CAAgCD,EAAMG,UAAUC,QAAQ,MACxD,wBAAQH,UAAU,YAAYI,QAASL,EAAMM,OAA7C,0BACA,wBAAQL,UAAU,YAAYI,QAASL,EAAMO,UAA7C,sCACA,wBAAQN,UAAU,oBAAoBI,QAASL,EAAMQ,SAArD,yCAfNT,EAAOU,aAAe,CACpBN,UAAW,EACXG,OAAQ,aACRC,UAAW,aACXC,SAAU,c,YCZG,SAASE,EAAUV,GAChC,IAAMW,EAAYC,IAAMC,YACxB,OACE,qBAAIZ,UAAU,kBAAd,UACE,sBAAMA,UAAU,aAAhB,SAA8BD,EAAMc,OACpC,sBAAMb,UAAU,gBAAhB,SAAiCD,EAAMe,UACvC,sBAAMd,UAAU,eAAhB,SACE,wBACEe,IAAKL,EACLM,SAAU,kBAAMjB,EAAMkB,UAAUlB,EAAMc,KAAMH,EAAUQ,QAAQC,QAC9DA,MAAOpB,EAAMqB,OAHf,SAIGrB,EAAMsB,WAAWC,KAAI,SAAAC,GAAI,OACxB,wBAAmBJ,MAAOI,EAA1B,SAAiCA,GAApBA,UAInB,sBAAMvB,UAAU,eAAhB,SAAgCD,EAAMyB,SACtC,sBAAMxB,UAAU,gBAAhB,SACE,uBAAOyB,KAAK,WACVX,QAASf,EAAMe,QACfU,OAAQzB,EAAMyB,OACdR,SAAU,kBAAOjB,EAAM2B,eAAe3B,EAAMc,OAC5Cc,QAAS5B,EAAM4B,eCrBV,SAASC,EAAS7B,GAC/B,OACE,0BAASC,UAAU,WAAnB,UACE,yBAAQA,UAAU,YAAlB,UACE,6BAAKD,EAAM8B,eACX,wBAAQ7B,UAAU,YAChBI,QAAS,kBAAML,EAAM+B,eAAe/B,EAAMgC,aAD5C,sCAEA,wBAAQ/B,UAAU,oBAChBI,QAAS,kBAAML,EAAMiC,mBAAmBjC,EAAMgC,aADhD,yCAGF,sBAAK/B,UAAU,kBAAf,UACE,sBAAMA,UAAU,aAAhB,0BACA,sBAAMA,UAAU,gBAAhB,0BACA,sBAAMA,UAAU,eAAhB,0BACA,sBAAMA,UAAU,eAAhB,0BACA,sBAAMA,UAAU,gBAAhB,6BAEDD,EAAMkC,QAAQX,KAAI,SAAAC,GAAI,OACrB,cAAC,EAAD,CAEEV,KAAMU,EAAKV,KACXC,QAASS,EAAKT,QACdM,OAAQG,EAAKH,OACbI,OAAQD,EAAKC,OACbG,QAASJ,EAAKI,QACdN,WAAYtB,EAAMsB,WAClBJ,UAAWlB,EAAMkB,UACjBS,eAAgB3B,EAAM2B,gBARjBH,EAAKV,YCvBpB,IAMeqB,EAJK,CAChBC,QAAS,kBAAMC,MAAM,GAAD,OAHR,0DAGQ,oBAA8BC,MAAK,SAAAC,GAAQ,OAAIA,EAASC,YCK1EC,G,MAAc,CAAEC,UAAW,GAAIrB,OAAQ,GAAIa,QAAS,KAEpDS,EAAsB,CAAC,CAAEC,SAAU,GAAIvB,OAAQ,GAAIN,QAAS,EAAGD,KAAM,GAAIW,OAAQ,EAAGG,SAAS,IAO7FiB,EAAY,SAACC,EAAYzB,GAAb,OAAwBA,EAAO0B,QAAO,SAACvB,GAAD,OAAUA,EAAKV,OAASgC,KAAYvB,KAAI,SAAAC,GAAI,OAAIA,EAAKC,UAAQuB,KAAK,KAQ3G,SAASC,IAAY,IAAD,EACCC,oBAAS,GADV,mBAC1BC,EAD0B,KACfC,EADe,OAGTF,mBAAST,GAHA,mBAG1BY,EAH0B,KAGpBC,EAHoB,OAKWJ,mBArBhB,GAgBK,mBAK1BK,EAL0B,KAKVC,EALU,OAMON,mBAASP,GANhB,mBAM1Bc,EAN0B,KAMZC,EANY,KASjCC,qBAAU,WACR,IAAMC,EAAMH,EAAaI,QAAO,SAACC,EAAKC,GAAN,OAAcA,EAAInC,QAAUkC,EAAMC,EAAIhD,QAAUgD,EAAItC,OAASqC,IAAK,GAC5FE,EAAaP,EAAaI,QAAO,SAACC,EAAKC,GAAN,OAAcA,EAAInC,QAAUkC,EAAMC,EAAIhD,QAAU+C,IAAK,GAE5FN,EADiC,IAAfQ,EAAmB,EAAKJ,EAAMI,KAE/C,CAACP,IAKJ,IAuBM1B,EAAiB,SAACC,GAAD,OAAgB0B,EACrCD,EACGlC,KAAI,SAAA0C,GAAS,kCACTA,GADS,IAEZrC,QAASqC,EAAUrB,WAAaZ,GAAciC,EAAUrC,eAMxDK,EAAqB,SAACD,GAAD,OAAgB0B,EACzCD,EACGlC,KAAI,SAAA0C,GAAS,kCACTA,GADS,IAEZrC,QAASqC,EAAUrB,WAAaZ,SAMhCL,EAAiB,SAAAb,GAAI,OAAI4C,EAC7BD,EACGlC,KAAI,SAAA0C,GAAS,OAAIA,EAAUnD,OAASA,EAAnB,2BACbmD,GADa,IAEhBrC,SAAUqC,EAAUrC,UAClBqC,OAMF/C,EAAY,SAACJ,EAAMoD,GAAP,OAAqBR,EACrCD,EACGlC,KAAI,SAAA0C,GAAS,OAAIA,EAAUnD,OAASA,EAAnB,2BACbmD,GADa,IAEhB5C,OAAQ6C,EACRzC,OAAQoB,EAAUqB,EAAWb,EAAKhC,UAChC4C,OAkBR,OAhBkB,IAAdd,IACFC,GAAa,GACbjB,EAAYC,UACTE,MAAK,SAAA6B,GACJb,EAAQa,GACRT,EACEU,KAAKC,MAAMD,KAAKE,UAAUH,EAAQjC,UAC/BX,KAAI,SAAAC,GAAI,kCACJA,GADI,IAEPC,OAAQoB,EAAUrB,EAAKH,OAAQ8C,EAAQ9C,QACvCO,SAAS,YAOnB,uBAAM3B,UAAU,YAAhB,UACE,cAAC,EAAD,CACEE,UAAWoD,EACXjD,OAlFS,kBAAMiE,OAAOC,SAASlE,UAmF/BE,SA/EW,kBAAMkD,EACrBD,EACGlC,KAAI,SAAA0C,GAAS,kCACTA,GADS,IAEZrC,SAAS,SA4ETrB,UAvEY,kBAAMmD,EACtBD,EACGlC,KAAI,SAAA0C,GAAS,kCACTA,GADS,IAEZrC,SAAS,WAoEVyB,EAAKX,UAAUnB,KAAI,SAAAqB,GAAQ,OAC1B,cAAC,EAAD,CAEEZ,WAAYY,EAAS6B,GACrB3C,aAAcc,EAAS9B,KACvBoB,SA/GUF,EA+GUY,EAAS6B,GA/GPvC,EA+GWuB,EA/GCvB,EAAQa,QAAO,SAAAkB,GAAS,OAAIA,EAAUrB,WAAaZ,MAAeW,GA+GrD+B,MAAK,SAACC,EAAGC,GAAJ,OAAUA,EAAEnD,OAASkD,EAAElD,SAAW,EAAImD,EAAE7D,QAAU4D,EAAE5D,QAAU6D,EAAEnD,OAASkD,EAAElD,UAC/HH,WAAY+B,EAAKhC,OAAOE,KAAI,SAAAC,GAAI,OAAIA,EAAKV,QACzCI,UAAWA,EACXa,eAAgBA,EAChBE,mBAAoBA,EACpBN,eAAgBA,GARXiB,EAAS6B,IA5GL,IAACzC,EAAYE,KAqHxB2C,aCxIO,SAASC,IAEtB,IAAMC,EAASnE,IAAMC,YAMrB,OACE,qBAAKG,IAAK+D,EAAQ9E,UAAU,MAA5B,SACE,cAAC,EAAD,MCdN,IAYe+E,EAZS,SAAAC,GAClBA,GAAeA,aAAuBC,UACxC,6BAAqB5C,MAAK,YAAkD,IAA/C6C,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOF,GACPG,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAQN,OCDdO,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFC,SAASC,eAAe,SAM1BZ,M","file":"static/js/main.a6cab29f.chunk.js","sourcesContent":["import React from 'react'\r\nimport './Header.css'\r\nimport PropTypes from 'prop-types'\r\n\r\nHeader.propTypes = {\r\n  avgPoints: PropTypes.number,\r\n  reload: PropTypes.func,\r\n  selectNone: PropTypes.func,\r\n  selectAll: PropTypes.func\r\n}\r\n\r\nHeader.defaultProps = {\r\n  avgPoints: 0,\r\n  reload: () => { },\r\n  checkNone: () => { },\r\n  checkAll: () => { }\r\n}\r\n\r\nexport default function Header(props) {\r\n  return (\r\n    <header className=\"header\">\r\n      <img className=\"avatar\" src=\"./favicon.ico\" />\r\n      <h1>少爷的绩点</h1>\r\n      <p className=\"avg-points\">平均绩点：{props.avgPoints.toFixed(2)}</p>\r\n      <button className=\"ms-button\" onClick={props.reload}>刷新</button>\r\n      <button className=\"ms-button\" onClick={props.checkNone}>全部清除</button>\r\n      <button className=\"ms-button primary\" onClick={props.checkAll}>全部勾选</button>\r\n    </header>\r\n  )\r\n}","import React from 'react'\r\nimport './ClassItem.css'\r\n\r\nexport default function ClassItem(props) {\r\n  const selectRef = React.createRef()\r\n  return (\r\n    <li className=\"class-list-item\">\r\n      <span className=\"class-name\">{props.name}</span>\r\n      <span className=\"class-credits\">{props.credits}</span>\r\n      <span className=\"class-grades\">\r\n        <select\r\n          ref={selectRef}\r\n          onChange={() => props.setGrades(props.name, selectRef.current.value)}\r\n          value={props.grades}>\r\n          {props.gradesList.map(item =>\r\n            <option key={item} value={item}>{item}</option>\r\n          )}\r\n        </select>\r\n      </span>\r\n      <span className=\"class-points\">{props.points}</span>\r\n      <span className=\"class-checked\">\r\n        <input type=\"checkbox\"\r\n          credits={props.credits}\r\n          points={props.points}\r\n          onChange={() => (props.checkClassItem(props.name))}\r\n          checked={props.checked} />\r\n      </span>\r\n    </li>\r\n  )\r\n}","import React from 'react'\r\nimport './Semester.css'\r\nimport ClassItem from './ClassItem/ClassItem.jsx'\r\n\r\nexport default function Semester(props) {\r\n  return (\r\n    <article className=\"semester\">\r\n      <header className=\"title-bar\">\r\n        <h2>{props.semesterName}</h2>\r\n        <button className=\"ms-button\"\r\n          onClick={() => props.selectSemester(props.semesterID)}>勾选学期</button>\r\n        <button className=\"ms-button primary\"\r\n          onClick={() => props.onlySelectSemester(props.semesterID)}>仅本学期</button>\r\n      </header>\r\n      <div className=\"class-list-head\">\r\n        <span className=\"name-field\">课程</span>\r\n        <span className=\"credits-field\">学分</span>\r\n        <span className=\"grades-field\">等级</span>\r\n        <span className=\"points-field\">绩点</span>\r\n        <span className=\"checked-field\">勾选</span>\r\n      </div>\r\n      {props.classes.map(item =>\r\n        <ClassItem\r\n          key={item.name}\r\n          name={item.name}\r\n          credits={item.credits}\r\n          grades={item.grades}\r\n          points={item.points}\r\n          checked={item.checked}\r\n          gradesList={props.gradesList}\r\n          setGrades={props.setGrades}\r\n          checkClassItem={props.checkClassItem} />\r\n      )\r\n      }\r\n    </article>\r\n  )\r\n}","const baseUrl = 'https://liangrongjia.github.io/abby-stitch.github.io/db'\r\n\r\nconst MyPointsAPI = {\r\n    fetchDB: () => fetch(`${baseUrl}/my-points.json`).then(response => response.json())\r\n}\r\n\r\nexport default MyPointsAPI","import React, { useState, useEffect } from 'react';\r\nimport Header from './Header/Header.jsx'\r\nimport Semester from './Semester/Semester.jsx'\r\nimport MyPointsAPI from './MyPointsAPI'\r\n\r\nimport './MyPoints.css'\r\n\r\n/* 默认值 */\r\nconst defaultData = { semesters: [], grades: [], classes: [] }\r\nconst defaultAvgPointsState = 0\r\nconst defaultClassesState = [{ semester: '', grades: '', credits: 0, name: '', points: 0, checked: false }]\r\n\r\n/**\r\n * 根据 gradesName 获取 points\r\n * @param { string } gradesName \r\n * @param { {name: string, points: number} [] } grades\r\n */\r\nconst getPoints = (gradesName, grades) => grades.filter((item) => item.name === gradesName).map(item => item.points).join('')\r\n/**\r\n * 获取某 semester 下的所有 classItem\r\n * @param { number } semesterID \r\n * @param { { semester: string, grades: string, credits: number, name: string, points: number, checked: boolean } [] } classes \r\n */\r\nconst getClasses = (semesterID, classes) => classes.filter(classItem => classItem.semester === semesterID) || defaultClassesState\r\n\r\nexport default function MyPoints() {\r\n  const [firstLoad, setFirstLoad] = useState(true)\r\n  /* 存储 fetch 数据 */\r\n  const [data, setData] = useState(defaultData)\r\n  /* 用 hook 存储组件的 state */\r\n  const [avgPointsState, setAvgPointsState] = useState(defaultAvgPointsState)\r\n  const [classesState, setClassesState] = useState(defaultClassesState)\r\n\r\n  /* classesState 变更 -> avgPointsState 更新 */\r\n  useEffect(() => {\r\n    const sum = classesState.reduce((acc, cur) => cur.checked ? acc + cur.credits * cur.points : acc, 0)\r\n    const creditsSum = classesState.reduce((acc, cur) => cur.checked ? acc + cur.credits : acc, 0)\r\n    const avgPoints = creditsSum === 0 ? 0 : (sum / creditsSum)\r\n    setAvgPointsState(avgPoints)\r\n  }, [classesState]);\r\n\r\n  /**\r\n   * 重新加载该子应用\r\n   */\r\n  const reload = () => window.location.reload()\r\n  /**\r\n   * 勾选全部 classItem\r\n   */\r\n  const checkAll = () => setClassesState(\r\n    classesState\r\n      .map(classItem => ({\r\n        ...classItem,\r\n        checked: true\r\n      })))\r\n  /**\r\n   * 取消全部的 classItem 勾选\r\n   */\r\n  const checkNone = () => setClassesState(\r\n    classesState\r\n      .map(classItem => ({\r\n        ...classItem,\r\n        checked: false\r\n      })))\r\n  /**\r\n   * 勾选某 semester 的全部 classItem\r\n   * @param { number } semesterID \r\n   */\r\n  const selectSemester = (semesterID) => setClassesState(\r\n    classesState\r\n      .map(classItem => ({\r\n        ...classItem,\r\n        checked: classItem.semester === semesterID || classItem.checked\r\n      })))\r\n  /**\r\n   * 仅勾选某 semester 的全部 classItem，其他 semester 的取消勾选\r\n   * @param { number } semesterID \r\n   */\r\n  const onlySelectSemester = (semesterID) => setClassesState(\r\n    classesState\r\n      .map(classItem => ({\r\n        ...classItem,\r\n        checked: classItem.semester === semesterID\r\n      })))\r\n  /**\r\n   * 勾选某 classItem\r\n   * @param { string } name \r\n   */\r\n  const checkClassItem = name => setClassesState(\r\n    classesState\r\n      .map(classItem => classItem.name === name ? {\r\n        ...classItem,\r\n        checked: !classItem.checked\r\n      } : classItem))\r\n  /**\r\n   * 设置某 classItem 的 grades\r\n   * @param { string } name \r\n   * @param { string } newGrades \r\n   */\r\n  const setGrades = (name, newGrades) => setClassesState(\r\n    classesState\r\n      .map(classItem => classItem.name === name ? {\r\n        ...classItem,\r\n        grades: newGrades,\r\n        points: getPoints(newGrades, data.grades)\r\n      } : classItem))\r\n\r\n  if (firstLoad === true) {\r\n    setFirstLoad(false)\r\n    MyPointsAPI.fetchDB()\r\n      .then(newData => {\r\n        setData(newData)\r\n        setClassesState(\r\n          JSON.parse(JSON.stringify(newData.classes))\r\n            .map(item => ({\r\n              ...item,\r\n              points: getPoints(item.grades, newData.grades),\r\n              checked: true\r\n            }))\r\n        )\r\n      })\r\n  }\r\n\r\n  return (\r\n    <main className='my-points'>\r\n      <Header\r\n        avgPoints={avgPointsState}\r\n        reload={reload}\r\n        checkAll={checkAll}\r\n        checkNone={checkNone} />\r\n      {data.semesters.map(semester =>\r\n        <Semester\r\n          key={semester.ID}\r\n          semesterID={semester.ID}\r\n          semesterName={semester.name}\r\n          classes={getClasses(semester.ID, classesState).sort((a, b) => b.points - a.points === 0 ? b.credits - a.credits : b.points - a.points)}\r\n          gradesList={data.grades.map(item => item.name)}\r\n          setGrades={setGrades}\r\n          selectSemester={selectSemester}\r\n          onlySelectSemester={onlySelectSemester}\r\n          checkClassItem={checkClassItem} />\r\n      ).reverse()}\r\n    </main>\r\n  )\r\n}","import React from 'react';\r\nimport './App.css'\r\nimport MyPoints from './MyPoints/MyPoints.jsx'\r\n\r\nexport default function ButtonAppBar() {\r\n\r\n  const appRef = React.createRef()\r\n\r\n  // const toggleFullScreen = () => {\r\n  //   document.fullscreenElement ? document.exitFullscreen() : appRef.current.requestFullscreen()    \r\n  // }\r\n\r\n  return (\r\n    <div ref={appRef} className='app'>\r\n      <MyPoints />\r\n    </div>\r\n  );\r\n}","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App/App.jsx';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}